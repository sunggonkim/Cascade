# Cascade: HPC ìŠ¤ì¼€ì¼ ê³„ì¸µì  KV ìºì‹œ ìŠ¤í† ë¦¬ì§€ (SC'26)

> **NERSC Perlmutter ìµœì í™”** | **4-Tier ì•„í‚¤í…ì²˜** | **LMCache ëŒ€ë¹„ 17.5ë°° ìŠ¤í† ë¦¬ì§€ ì ˆì•½**

CascadeëŠ” ê±°ëŒ€ ì–¸ì–´ ëª¨ë¸(LLM) ì¶”ë¡  ì‹œ ë°œìƒí•˜ëŠ” **ë©”ëª¨ë¦¬ ë³‘ëª©(Memory Wall)** ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì„¤ê³„ëœ HPC-Native ë¶„ì‚° ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ“š ë””ë ‰í† ë¦¬ êµ¬ì¡°

ì´ ë ˆí¬ì§€í† ë¦¬ëŠ” SC'26 ë…¼ë¬¸ ì œì¶œì„ ìœ„í•œ ì „ì²´ í”„ë¡œì íŠ¸ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

```bash
/pscratch/sd/s/sgkim/Skim-cascade/
â”œâ”€â”€ cascade_Code/       # ğŸš€ Cascade ë©”ì¸ ì†ŒìŠ¤ì½”ë“œ (src/cascade)
â”œâ”€â”€ benchmark/          # ğŸ“Š ë²¤ì¹˜ë§ˆí¬ í”„ë ˆì„ì›Œí¬ (adapters, data_generator)
â”œâ”€â”€ third_party/        # ğŸ“¦ ë¹„êµêµ° êµ¬í˜„ì²´ (LMCache, PDC, Redis ë“± - NO Mock)
â”œâ”€â”€ paper/              # ğŸ“ SC'26 ë…¼ë¬¸ LaTeX ì†ŒìŠ¤
â””â”€â”€ scripts/            # ğŸ› ï¸ ì‹¤í–‰ ë° ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
```

---

## ğŸ¯ ë¬¸ì œ ì •ì˜: LLM ì¶”ë¡ ì˜ 80%ëŠ” "ê¸°ë‹¤ë¦¼"ì´ë‹¤

LLM ì¶”ë¡  ì‹œê°„ì˜ ëŒ€ë¶€ë¶„ì€ ì—°ì‚°(Compute)ì´ ì•„ë‹Œ **KV ìºì‹œ ë¡œë”©(I/O)**ì— ì†Œë¹„ë©ë‹ˆë‹¤. íŠ¹íˆ HPC í™˜ê²½ì—ì„œëŠ” ê¸°ì¡´ í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ ì†”ë£¨ì…˜ë“¤ì´ í•œê³„ë¥¼ ë³´ì…ë‹ˆë‹¤.

```mermaid
pie title LLM ì¶”ë¡  ì‹œê°„ ë¶„ì„ (LLaMA-70B)
    "KV ìºì‹œ ë¡œë”© (I/O)" : 80
    "GPU ì—°ì‚° (Compute)" : 20
```

### âŒ ê¸°ì¡´ ì†”ë£¨ì…˜ì˜ í•œê³„

| ì‹œìŠ¤í…œ | í•œê³„ì  | HPC í™˜ê²½ì—ì„œì˜ ë¬¸ì œ |
|--------|--------|---------------------|
| **LMCache** | **ì¤‘ë³µ ì €ì¥** | ì„¸ì…˜ë§ˆë‹¤ ê°™ì€ ë°ì´í„°ë¥¼ ì¤‘ë³µ ì €ì¥ (ìŠ¤í† ë¦¬ì§€ ë‚­ë¹„) |
| **vLLM** | **ë©”ëª¨ë¦¬ ì œí•œ** | ë…¸ë“œë‹¹ GPU ë©”ëª¨ë¦¬(160GB) í•œê³„ë¡œ ê¸´ ë¬¸ë§¥ ë¶ˆê°€ |
| **Redis** | **ì§ë ¬í™” ë³‘ëª©** | ë„¤íŠ¸ì›Œí¬ ì§ë ¬/ì—­ì§ë ¬í™” ì˜¤ë²„í—¤ë“œë¡œ ëŠë¦¼ |
| **PDC** | **ì“°ê¸° ì§€ì—°** | ë©”íƒ€ë°ì´í„° ë™ê¸°í™” ë° fsync ì˜¤ë²„í—¤ë“œ |

---

## ğŸš€ Cascade: 4ê³„ì¸µ HPC ìŠ¤í† ë¦¬ì§€

CascadeëŠ” GPU HBMë¶€í„° Lustre PFSê¹Œì§€ 4ë‹¨ê³„ ê³„ì¸µì„ Slingshot ì¸í„°ì»¤ë„¥íŠ¸ë¡œ ë¬¶ì–´, **ë¹ˆë„ëŠ” ë†’ì´ê³ (Hot) ë¹„ìš©ì€ ë‚®ì¶¥ë‹ˆë‹¤(Cold).**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Cascade 4-Tier Architecture                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  [Tier 1] GPU HBM      ğŸš€ 1555 GB/s  (ê°€ì¥ ë¹ ë¦„, ìš©ëŸ‰ ì‘ìŒ)             â”‚
â”‚            â”‚                                                            â”‚
â”‚            â–¼ evict (async)                                              â”‚
â”‚                                                                         â”‚
â”‚  [Tier 2] Local SHM    âš¡ 204 GB/s   (/dev/shm, IPC ìµœì í™”)             â”‚
â”‚            â”‚                                                            â”‚
â”‚            â–¼ MPI (Slingshot-11)                                         â”‚
â”‚                                                                         â”‚
â”‚  [Tier 3] Remote RAM   ğŸŒ 100 GB/s   (ë‹¤ë¥¸ ë…¸ë“œì˜ ìœ íœ´ ë©”ëª¨ë¦¬ í™œìš©)       â”‚
â”‚            â”‚                                                            â”‚
â”‚            â–¼ async flush                                                â”‚
â”‚                                                                         â”‚
â”‚  [Tier 4] Lustre PFS   ğŸ’¾ 17 GB/s    (ë¬´ì œí•œ ìš©ëŸ‰, ì˜êµ¬ ì €ì¥)            â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ì„±ëŠ¥ í‰ê°€ (LMCache vs Cascade)

**NERSC Perlmutter 4ë…¸ë“œ (A100 x16)** í™˜ê²½ì—ì„œ 500GB ë°ì´í„°ì…‹ìœ¼ë¡œ ì¸¡ì •í•œ ê²°ê³¼ì…ë‹ˆë‹¤.

### 1ï¸âƒ£ Hot Data ì„±ëŠ¥ (ë©”ëª¨ë¦¬ íˆíŠ¸)
> **Cascade ìŠ¹ë¦¬**: OS Page Cacheì— ì˜ì¡´í•˜ëŠ” LMCacheë³´ë‹¤ **ì§ì ‘ ë©”ëª¨ë¦¬ ì ‘ê·¼(mmap)** ë°©ì‹ì´ ë” ë¹ ë¦…ë‹ˆë‹¤.

| ì‹œìŠ¤í…œ | ì½ê¸° ì†ë„ (GB/s) | ë¹„ê³  |
|--------|------------------|------|
| **Cascade** | **160.9** | **Tier 1/2 íˆíŠ¸ (Zero-copy)** |
| LMCache | 145.4 | OS Page Cache ì˜ì¡´ |
| PDC | 135.6 | - |
| Redis | 2.6 | ë„¤íŠ¸ì›Œí¬ ë³‘ëª© |

### 2ï¸âƒ£ Unique Capability: ì¤‘ë³µ ì œê±° (Deduplication)
> **17.5ë°° íš¨ìœ¨**: 100ê°œ ì„¸ì…˜ì´ ê°™ì€ System Promptë¥¼ ê³µìœ í•  ë•Œ, CascadeëŠ” ë‹¨ 1ë²ˆë§Œ ì €ì¥í•©ë‹ˆë‹¤.

```
[ ì‹œë‚˜ë¦¬ì˜¤: 100 users sharing basic prompt ]

LMCache (Session-based ID)
ğŸ’¾ [User1] [User2] ... [User100]
âŒ 2100 MB ì‚¬ìš©

Cascade (Content-Addressed)
ğŸ’¾ [Hash(Prompt)]
âœ… 120 MB ì‚¬ìš© (17.5ë°° ì ˆì•½!)
```

### 3ï¸âƒ£ Multi-node Scaling
> **ì„ í˜•ì  í™•ì¥**: ë…¸ë“œë¥¼ ëŠ˜ë¦´ìˆ˜ë¡ ì‚¬ìš© ê°€ëŠ¥í•œ ëŒ€ì—­í­ì´ ë¹„ë¡€í•´ì„œ ì¦ê°€í•©ë‹ˆë‹¤.

| ë…¸ë“œ ìˆ˜ | LMCache (Single) | Cascade (Distributed) | Speedup |
|:-------:|:----------------:|:---------------------:|:-------:|
| 1 | 13.6 GB/s | 13.6 GB/s | - |
| **4** | 13.6 GB/s | **54.3 GB/s** | **4.0x** |
| 64 | 13.6 GB/s | ~800 GB/s (est) | **~60x** |

---

## ğŸ› ï¸ ì‹œì‘í•˜ê¸° (Quick Start)

### 1. í™˜ê²½ ì„¤ì •
```bash
# Perlmutter í™˜ê²½ ë¡œë“œ
module load python cudatoolkit cray-mpich
export ACTION=install
source scripts/install_deps.sh
```

### 2. ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
```bash
# ë°ì´í„° ìƒì„± (ìƒëµ ê°€ëŠ¥)
./scripts/generate_real_data.sh

# ì „ì²´ ì‹œìŠ¤í…œ ë¹„êµ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰
python -m benchmark.run_benchmark --workload read_latency --systems cascade lmcache pdc redis
```

---

## ğŸ‘¨â€ğŸ’» ê¸°ì—¬ (Contribution)

ì´ í”„ë¡œì íŠ¸ëŠ” **HPC ì—°êµ¬ì‹¤**ì—ì„œ ì§„í–‰ ì¤‘ì´ë©°, PRì€ ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤.
- **Main Developer**: Sunggon Kim
- **Target**: Supercomputing 2026 (SC'26)

> *Cascade: Pouring Data at HPC Scale.* ğŸŒŠ
